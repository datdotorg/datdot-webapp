const bel = require('bel')
const nav = require('components/datdot-ui-navigation')
const actions = require('components/datdot-ui-actions')
const message_maker = require('message-maker')

module.exports = i_footer
function i_footer ({page = '*', flow = 'ui-footer', name = '.', body = {}, to = '#'}, protocol) {
    const recipients = []
    const make = message_maker(`${name} / ${flow} / ${page}`)

    
    function widget () {
        const send = protocol(get)
        const el = bel`
        <footer>
            ${actions({name: `${name}-actions`}, footer_protocol(`${name}-actions`) )}
            ${nav({name: `${name}-nav`, body: body.nav, to}, footer_protocol(`${name}-nav`))}
        </footer>`

        return el

        function footer_protocol (name) {
            return send => {
                recipients[name] = send
                return get
            }
        }
        function get (msg) {
            const {head, type, refs, meta, data} = msg
            const from = head[0].split(' / ')[0]
            send(make(msg))
        }
    }
    

    return widget()
}